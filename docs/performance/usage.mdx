---
title: Performance Monitoring
sidebar_label: Usage
---


To start using Performance Monitoring for Firebase package within your project, import it at the top of your project files:

```dart
import 'package:firebase_performance/firebase_performance.dart';
```

Before using Performance Monitoring, you must first have ensured you have [initialized FlutterFire](overview#initializing-flutterfire).

To create a new Performance Monitoring for Firebase instance, call the [`instance`](!firebase_performance.FirebasePerformance.instance) getter on [`FirebaseFunctions`](!firebase_performance.FirebasePerformance):

```dart
FirebasePerformance performance = FirebasePerformance.instance;
```

By default, this allows you to interact with Performance Monitoring using the default Firebase App. Please note, only the default app is available with
Performance Monitoring for web, iOS & android at this moment in time.

## Custom tracing

You can create your own traces to monitor performance data associated with specific code in your app. With a custom code trace, you can
measure how long it takes your app to complete a specific task or a set of tasks, for example loading a set of images or querying your database.
To setup a custom trace, see below:

```dart
FirebasePerformance performance = FirebasePerformance.instance;

// Create a `Trace` instance and pass in a name so it can be tracked on your Firebase console:
Trace trace = performance.newTrace('test_trace');

// start the trace
await trace.start();

// Set metrics you wish to track
trace.setMetric('sum', 200);
trace.setMetric('time', 342340435);

// You may also assign up to 5 attributes for each trace
trace.putAttribute('foo', 'bar');

// Increment metric (205 will be sent when the Trace stops)
trace.incrementMetric('sum', 5);

// Stops the trace. This is when the data is sent to the Firebase server and it will appear in your Firebase console
await trace.stop();
```

## HTTP Request Tracing

The network request traces automatically collected by Performance Monitoring include most network requests for your app.
However, some requests might not be reported or you might use a different library to make network requests. In these cases,
you can use the Performance Monitoring API to manually instrument custom network request traces. Custom network request traces
are only supported for Apple and Android apps. To setup a custom network request trace, see below:

```dart
// Using http package to make a network request
import 'package:http/http.dart' as http;

FirebasePerformance performance = FirebasePerformance.instance;

// Create a `HttpMetric` instance using the URL you're requesting as well as the type of request
String url = 'https://firebase.flutter.dev';
HttpMetric metric = performance
        .newHttpMetric(url, HttpMethod.Get);

// You may also assign up to 5 attributes for each trace
metric.putAttribute('foo', 'bar');

// Start the trace
await metric.start();

// Make the request
Uri url = Uri.parse(url);
var response = await http.get(url);

// Set specific headers to be collated
metric.responseContentType = response.headers['Content-Type'];
metric.httpResponseCode = response.statusCode;
metric.responsePayloadSize = response.contentLength;

// Stops the trace. This is when the data is sent to the Firebase server and it will appear in your Firebase console
await metric.stop();

```

## Stop Custom Data Collection

To stop custom data collection, you can call `setPerformanceCollectionEnabled` like in the example:

```dart
FirebasePerformance performance = FirebasePerformance.instance;

// Custom data collection is, by default, enabled
await performance.isPerformanceCollectionEnabled();

// Set custom data collection to `false`
await performance.setPerformanceCollectionEnabled(false);
```
